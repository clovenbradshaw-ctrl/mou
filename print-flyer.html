<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Print a Flyer | Nashville Community Safety Network</title>
  <link rel="icon" type="image/png" href="https://storage.googleapis.com/intelechia-content/Screenshot%202025-11-28%20at%207.34.59%E2%80%AFPM.png">
  <meta name="description" content="Download and print flyers to help spread the word about the surveillance MOU in your community.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;500;600;700;800&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    :root {
      --bg-cream: #F5F0E6;
      --bg-cream-dark: #EBE5D9;
      --text-dark: #2C2C2C;
      --text-body: #444444;
      --text-muted: #666666;
      --accent-teal: #4A7C6F;
      --accent-rust: #B85C38;
      --border-light: #D4CFC3;
      --highlight-yellow: #F9E4B7;
    }

    body {
      font-family: 'Lora', Georgia, serif;
      background-color: var(--bg-cream);
      color: var(--text-body);
      line-height: 1.7;
      font-size: 17px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    ::selection {
      background: var(--accent-rust);
      color: white;
    }

    /* Header */
    .site-header {
      padding: 1rem 1.5rem;
      border-bottom: 2px solid var(--border-light);
      background: var(--bg-cream);
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .site-name {
      font-family: 'Archivo', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--accent-teal);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .site-name a {
      color: inherit;
      text-decoration: none;
    }

    .back-link {
      font-family: 'Archivo', sans-serif;
      font-size: 0.85rem;
      color: var(--text-muted);
      text-decoration: none;
    }

    .back-link:hover {
      color: var(--accent-teal);
    }

    /* Page Title */
    .page-header {
      padding: 2rem 1.5rem;
      background: linear-gradient(135deg, var(--accent-rust) 0%, #943d20 100%);
      color: white;
      text-align: center;
    }

    .page-header h1 {
      font-family: 'Archivo', sans-serif;
      font-size: clamp(1.75rem, 5vw, 2.5rem);
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 0.5rem;
    }

    .page-header p {
      font-size: 1.1rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
    }

    /* Flyer Gallery */
    .flyer-section {
      flex: 1;
      padding: 2rem 1.5rem;
      background: white;
    }

    .flyer-gallery {
      max-width: 1000px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
    }

    .flyer-page {
      background: var(--bg-cream);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .flyer-page:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }

    .flyer-label {
      font-family: 'Archivo', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      padding: 1rem 1.5rem 0.5rem;
      background: var(--bg-cream);
    }

    .flyer-image-wrapper {
      padding: 0 1rem 1rem;
      background: var(--bg-cream);
    }

    .flyer-image-wrapper img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      cursor: zoom-in;
      transition: opacity 0.2s ease;
    }

    .flyer-image-wrapper img:hover {
      opacity: 0.9;
    }

    /* Image Zoom Modal */
    .image-zoom-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 10000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .image-zoom-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 1;
    }

    .zoom-image-container {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .zoom-image-container.dragging {
      cursor: grabbing;
    }

    .zoom-image-container img {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
      transition: transform 0.2s ease;
      user-select: none;
      -webkit-user-drag: none;
    }

    .zoom-image-container.fullscreen img {
      max-width: 100%;
      max-height: 100%;
    }

    .zoom-controls {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 0.75rem;
      background: rgba(0, 0, 0, 0.7);
      padding: 0.75rem 1rem;
      border-radius: 50px;
      backdrop-filter: blur(10px);
      z-index: 10001;
    }

    .zoom-btn {
      width: 44px;
      height: 44px;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 1.25rem;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Archivo', sans-serif;
      font-weight: 600;
    }

    .zoom-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }

    .zoom-btn:active {
      transform: scale(0.95);
    }

    .zoom-btn.download-btn {
      background: var(--accent-teal);
    }

    .zoom-btn.download-btn:hover {
      background: #5a9c8f;
    }

    .zoom-close-btn {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      width: 50px;
      height: 50px;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 2rem;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10001;
      backdrop-filter: blur(10px);
    }

    .zoom-close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: rotate(90deg) scale(1.1);
    }

    .zoom-info {
      position: fixed;
      top: 1.5rem;
      left: 1.5rem;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 0.75rem 1.25rem;
      border-radius: 8px;
      font-family: 'Archivo', sans-serif;
      font-size: 0.9rem;
      z-index: 10001;
      backdrop-filter: blur(10px);
      max-width: 300px;
    }

    .zoom-percentage {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      font-family: 'Archivo', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      z-index: 10002;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .zoom-percentage.show {
      opacity: 1;
    }

    .zoom-nav-btn {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 1.5rem;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10001;
      backdrop-filter: blur(10px);
      opacity: 0;
      pointer-events: none;
    }

    .zoom-nav-btn.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .zoom-nav-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-50%) scale(1.1);
    }

    .zoom-nav-btn:active {
      transform: translateY(-50%) scale(0.95);
    }

    .zoom-nav-btn.prev {
      left: 1.5rem;
    }

    .zoom-nav-btn.next {
      right: 1.5rem;
    }

    .zoom-progress {
      position: fixed;
      bottom: 7rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 0.5rem;
      z-index: 10001;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .zoom-progress.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .zoom-progress-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.2s ease;
      border: 2px solid transparent;
    }

    .zoom-progress-dot:hover {
      background: rgba(255, 255, 255, 0.5);
      transform: scale(1.2);
    }

    .zoom-progress-dot.active {
      background: white;
      transform: scale(1.3);
    }

    .zoom-counter {
      position: fixed;
      top: 1.5rem;
      right: 5rem;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-family: 'Archivo', sans-serif;
      font-size: 0.9rem;
      z-index: 10001;
      backdrop-filter: blur(10px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .zoom-counter.visible {
      opacity: 1;
    }

    .swipe-hint {
      position: fixed;
      bottom: 8rem;
      left: 50%;
      transform: translateX(-50%);
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.85rem;
      font-family: 'Archivo', sans-serif;
      z-index: 10001;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }

    .swipe-hint.visible {
      opacity: 1;
    }

    @media (max-width: 768px) {
      .zoom-nav-btn {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .zoom-nav-btn.prev {
        left: 0.5rem;
      }

      .zoom-nav-btn.next {
        right: 0.5rem;
      }

      .zoom-controls {
        bottom: 1rem;
        padding: 0.5rem 0.75rem;
        gap: 0.5rem;
      }

      .zoom-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }

      .zoom-info {
        left: 0.75rem;
        top: 0.75rem;
        padding: 0.5rem 0.75rem;
        font-size: 0.8rem;
        max-width: 200px;
      }

      .zoom-close-btn {
        width: 40px;
        height: 40px;
        font-size: 1.5rem;
        top: 0.75rem;
        right: 0.75rem;
      }

      .zoom-counter {
        right: 3.5rem;
        top: 0.75rem;
        padding: 0.4rem 0.75rem;
        font-size: 0.8rem;
      }
    }

    /* Print Section */
    .print-section {
      text-align: center;
      padding: 2rem 1.5rem;
      background: var(--bg-cream);
    }

    .print-section h2 {
      font-family: 'Archivo', sans-serif;
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }

    .print-section p {
      color: var(--text-muted);
      margin-bottom: 1.5rem;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }

    .print-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .btn-print {
      display: inline-block;
      background: var(--accent-rust);
      color: white;
      padding: 0.875rem 2rem;
      font-family: 'Archivo', sans-serif;
      font-weight: 700;
      font-size: 0.95rem;
      border-radius: 50px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-print:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(184, 92, 56, 0.4);
    }

    .btn-download {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: var(--accent-teal);
      color: white;
      padding: 0.875rem 2rem;
      font-family: 'Archivo', sans-serif;
      font-weight: 700;
      font-size: 0.95rem;
      border-radius: 50px;
      text-decoration: none;
      transition: all 0.2s ease;
    }

    .btn-download:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(74, 124, 111, 0.4);
    }

    /* Print Styles */
    @media print {
      .site-header,
      .page-header,
      .print-section,
      footer {
        display: none !important;
      }

      body {
        background: white;
      }

      .flyer-section {
        padding: 0;
      }

      .flyer-gallery {
        display: block;
      }

      .flyer-page {
        box-shadow: none;
        background: white;
        page-break-after: always;
        border-radius: 0;
      }

      .flyer-page:last-child {
        page-break-after: avoid;
      }

      .flyer-label {
        display: none;
      }

      .flyer-image-wrapper {
        padding: 0;
        background: white;
      }

      .flyer-image-wrapper img {
        width: 100%;
        max-width: 100%;
        border-radius: 0;
        box-shadow: none;
      }
    }

    /* Footer */
    footer {
      background: var(--text-dark);
      color: white;
      text-align: center;
      padding: 2rem 1.5rem;
    }

    .footer-brand {
      font-family: 'Archivo', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }

    .footer-tagline {
      font-size: 0.9rem;
      opacity: 0.7;
      margin-bottom: 1rem;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex-wrap: wrap;
    }

    .footer-links a {
      font-family: 'Archivo', sans-serif;
      font-size: 0.85rem;
      color: white;
      opacity: 0.8;
      text-decoration: none;
    }

    .footer-links a:hover {
      opacity: 1;
    }

    @media (max-width: 640px) {
      .embed-container {
        padding: 0.5rem;
      }

      .embed-wrapper {
        min-height: 70vh;
        border-radius: 4px;
      }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="site-header">
    <div class="header-inner">
      <div class="site-name"><a href="index.html">Nashville Community Safety Network</a></div>
      <a href="index.html" class="back-link">‚Üê Back to Main Page</a>
    </div>
  </header>

  <!-- Page Header -->
  <div class="page-header">
    <h1>Print a Flyer</h1>
    <p>Download and share in your community</p>
  </div>

  <!-- Flyer Gallery -->
  <section class="flyer-section">
    <div class="flyer-gallery">
      <div class="flyer-page">
        <div class="flyer-label">Page 1 - Front</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/1.png" alt="Flyer Page 1 - Information about the surveillance MOU" loading="eager">
        </div>
      </div>
      <div class="flyer-page">
        <div class="flyer-label">Page 2 - Back</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/2.png" alt="Flyer Page 2 - How to take action" loading="eager">
        </div>
      </div>
      <div class="flyer-page">
        <div class="flyer-label">Page 3</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/mou/1000012892.png" alt="Flyer Page 3" loading="lazy">
        </div>
      </div>
      <div class="flyer-page">
        <div class="flyer-label">Page 4</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/mou/1000012893.jpg" alt="Flyer Page 4" loading="lazy">
        </div>
      </div>
      <div class="flyer-page">
        <div class="flyer-label">Page 5</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/mou/1000012894.png" alt="Flyer Page 5" loading="lazy">
        </div>
      </div>
      <div class="flyer-page">
        <div class="flyer-label">Page 6</div>
        <div class="flyer-image-wrapper">
          <img src="https://storage.googleapis.com/intelechia-content/im/mou/1000012895.png" alt="Flyer Page 6" loading="lazy">
        </div>
      </div>
    </div>
  </section>

  <!-- Print Section -->
  <div class="print-section">
    <h2>Ready to Print?</h2>
    <p>Print double-sided for a complete flyer to share in your community.</p>
    <div class="print-buttons">
      <button class="btn-print" onclick="window.print()">Print Flyer</button>
      <a href="https://storage.googleapis.com/intelechia-content/im/1.png" download class="btn-download" target="_blank">Download Page 1</a>
      <a href="https://storage.googleapis.com/intelechia-content/im/2.png" download class="btn-download" target="_blank">Download Page 2</a>
      <a href="https://storage.googleapis.com/intelechia-content/im/mou/1000012892.png" download class="btn-download" target="_blank">Download Page 3</a>
      <a href="https://storage.googleapis.com/intelechia-content/im/mou/1000012893.jpg" download class="btn-download" target="_blank">Download Page 4</a>
      <a href="https://storage.googleapis.com/intelechia-content/im/mou/1000012894.png" download class="btn-download" target="_blank">Download Page 5</a>
      <a href="https://storage.googleapis.com/intelechia-content/im/mou/1000012895.png" download class="btn-download" target="_blank">Download Page 6</a>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-brand">Nashville Community Safety Network</div>
    <p class="footer-tagline">Protecting civil liberties through democratic accountability.</p>
    <div class="footer-links">
      <a href="index.html">Main Page</a>
      <a href="index.html#take-action">Take Action</a>
      <a href="https://www.instagram.com/nashcommunitysafetynetwork_/" target="_blank">Instagram</a>
    </div>
  </footer>

  <script>
    // ========================================
    // IMAGE ZOOM FUNCTIONALITY WITH DOWNLOAD
    // ========================================

    (function() {
      // Create zoom modal structure
      const modalHTML = `
        <div class="image-zoom-modal" id="imageZoomModal">
          <button class="zoom-close-btn" id="zoomCloseBtn" aria-label="Close">&times;</button>
          <div class="zoom-info" id="zoomInfo">
            <div id="zoomInfoTitle">Flyer</div>
          </div>
          <div class="zoom-counter" id="zoomCounter">1 / 6</div>
          <div class="zoom-percentage" id="zoomPercentage">100%</div>
          <button class="zoom-nav-btn prev" id="zoomPrevBtn" aria-label="Previous image">&#8249;</button>
          <button class="zoom-nav-btn next" id="zoomNextBtn" aria-label="Next image">&#8250;</button>
          <div class="zoom-image-container" id="zoomImageContainer">
            <img id="zoomImage" src="" alt="Zoomed flyer" />
          </div>
          <div class="zoom-progress" id="zoomProgress"></div>
          <div class="swipe-hint" id="swipeHint">Swipe to navigate</div>
          <div class="zoom-controls">
            <button class="zoom-btn" id="zoomOutBtn" title="Zoom Out (-)">&#8722;</button>
            <button class="zoom-btn" id="zoomResetBtn" title="Reset Zoom (0)">&#8634;</button>
            <button class="zoom-btn" id="zoomInBtn" title="Zoom In (+)">+</button>
            <a class="zoom-btn download-btn" id="downloadBtn" title="Download Image" download>&#8681;</a>
          </div>
        </div>
      `;

      // Append modal to body
      document.body.insertAdjacentHTML('beforeend', modalHTML);

      // Get modal elements
      const modal = document.getElementById('imageZoomModal');
      const zoomImage = document.getElementById('zoomImage');
      const zoomContainer = document.getElementById('zoomImageContainer');
      const closeBtn = document.getElementById('zoomCloseBtn');
      const zoomInBtn = document.getElementById('zoomInBtn');
      const zoomOutBtn = document.getElementById('zoomOutBtn');
      const zoomResetBtn = document.getElementById('zoomResetBtn');
      const downloadBtn = document.getElementById('downloadBtn');
      const zoomPercentage = document.getElementById('zoomPercentage');
      const zoomInfo = document.getElementById('zoomInfo');
      const zoomInfoTitle = document.getElementById('zoomInfoTitle');
      const zoomCounter = document.getElementById('zoomCounter');
      const prevBtn = document.getElementById('zoomPrevBtn');
      const nextBtn = document.getElementById('zoomNextBtn');
      const progressContainer = document.getElementById('zoomProgress');
      const swipeHint = document.getElementById('swipeHint');

      // Zoom state
      let currentZoom = 1;
      let currentX = 0;
      let currentY = 0;
      let isDragging = false;
      let startX = 0;
      let startY = 0;

      // Gallery state
      let galleryImages = [];
      let currentImageIndex = 0;

      // Momentum scrolling state
      let velocityX = 0;
      let velocityY = 0;
      let lastMoveTime = 0;
      let lastMoveX = 0;
      let lastMoveY = 0;
      let momentumAnimation = null;

      // Swipe state
      let touchStartX = 0;
      let touchStartY = 0;
      let swipeStartX = 0;
      let swipeStartY = 0;
      let isSwipeGesture = false;

      // Zoom settings
      const ZOOM_STEP = 0.25;
      const MIN_ZOOM = 0.5;
      const MAX_ZOOM = 5;
      const SWIPE_THRESHOLD = 50;
      const SWIPE_CLOSE_THRESHOLD = 100;
      const MOMENTUM_FRICTION = 0.95;
      const MIN_VELOCITY = 0.5;

      // Show zoom percentage temporarily
      let percentageTimeout;
      function showZoomPercentage() {
        zoomPercentage.textContent = Math.round(currentZoom * 100) + '%';
        zoomPercentage.classList.add('show');
        clearTimeout(percentageTimeout);
        percentageTimeout = setTimeout(() => {
          zoomPercentage.classList.remove('show');
        }, 800);
      }

      // Update image transform
      function updateTransform() {
        zoomImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${currentZoom})`;
      }

      // Gallery navigation functions
      function updateGalleryUI() {
        const hasMultipleImages = galleryImages.length > 1;

        // Update counter
        if (hasMultipleImages) {
          zoomCounter.textContent = `${currentImageIndex + 1} / ${galleryImages.length}`;
          zoomCounter.classList.add('visible');
        } else {
          zoomCounter.classList.remove('visible');
        }

        // Update navigation buttons
        if (hasMultipleImages) {
          prevBtn.classList.add('visible');
          nextBtn.classList.add('visible');
        } else {
          prevBtn.classList.remove('visible');
          nextBtn.classList.remove('visible');
        }

        // Update progress dots
        if (hasMultipleImages) {
          progressContainer.innerHTML = '';
          galleryImages.forEach((_, index) => {
            const dot = document.createElement('div');
            dot.className = 'zoom-progress-dot';
            if (index === currentImageIndex) {
              dot.classList.add('active');
            }
            dot.addEventListener('click', () => goToImage(index));
            progressContainer.appendChild(dot);
          });
          progressContainer.classList.add('visible');
        } else {
          progressContainer.classList.remove('visible');
        }

        // Show swipe hint temporarily for mobile
        if (hasMultipleImages && window.innerWidth < 768) {
          swipeHint.classList.add('visible');
          setTimeout(() => {
            swipeHint.classList.remove('visible');
          }, 3000);
        }
      }

      function goToImage(index) {
        if (index < 0 || index >= galleryImages.length) return;

        currentImageIndex = index;
        const imgData = galleryImages[index];

        // Load new image
        zoomImage.src = imgData.src;
        zoomImage.alt = imgData.alt || 'Flyer';
        zoomInfoTitle.textContent = imgData.label || 'Flyer';

        // Update download button
        downloadBtn.href = imgData.src;

        // Reset zoom and position
        currentZoom = 1;
        currentX = 0;
        currentY = 0;
        updateTransform();

        // Update UI
        updateGalleryUI();
      }

      function navigateNext() {
        if (currentImageIndex < galleryImages.length - 1) {
          goToImage(currentImageIndex + 1);
        }
      }

      function navigatePrev() {
        if (currentImageIndex > 0) {
          goToImage(currentImageIndex - 1);
        }
      }

      function navigateFirst() {
        goToImage(0);
      }

      function navigateLast() {
        goToImage(galleryImages.length - 1);
      }

      // Open zoom modal
      function openZoomModal(imgElement) {
        const imgSrc = imgElement.src;
        const imgAlt = imgElement.alt || 'Flyer';

        // Get the label from the flyer-page
        const flyerPage = imgElement.closest('.flyer-page');
        const label = flyerPage ? flyerPage.querySelector('.flyer-label')?.textContent || imgAlt : imgAlt;

        // Build gallery array from all flyer images
        galleryImages = [];
        const flyerImages = document.querySelectorAll('.flyer-image-wrapper img');
        flyerImages.forEach((img) => {
          const page = img.closest('.flyer-page');
          const pageLabel = page ? page.querySelector('.flyer-label')?.textContent || img.alt : img.alt;
          galleryImages.push({
            src: img.src,
            alt: img.alt || 'Flyer',
            label: pageLabel
          });
        });

        // Find current image index
        currentImageIndex = Array.from(flyerImages).indexOf(imgElement);
        if (currentImageIndex === -1) currentImageIndex = 0;

        // Set image and info
        zoomImage.src = imgSrc;
        zoomImage.alt = imgAlt;
        zoomInfoTitle.textContent = label;

        // Set download link
        downloadBtn.href = imgSrc;

        // Reset state
        currentZoom = 1;
        currentX = 0;
        currentY = 0;
        updateTransform();

        // Update gallery UI
        updateGalleryUI();

        // Show modal
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      // Close zoom modal
      function closeZoomModal() {
        modal.classList.remove('active');
        document.body.style.overflow = '';
        setTimeout(() => {
          zoomImage.src = '';
          currentZoom = 1;
          currentX = 0;
          currentY = 0;
          updateTransform();
        }, 300);
      }

      // Zoom in
      function zoomIn() {
        if (currentZoom < MAX_ZOOM) {
          currentZoom = Math.min(currentZoom + ZOOM_STEP, MAX_ZOOM);
          updateTransform();
          showZoomPercentage();
        }
      }

      // Zoom out
      function zoomOut() {
        if (currentZoom > MIN_ZOOM) {
          currentZoom = Math.max(currentZoom - ZOOM_STEP, MIN_ZOOM);
          if (currentZoom <= 1) {
            currentX = 0;
            currentY = 0;
          }
          updateTransform();
          showZoomPercentage();
        }
      }

      // Reset zoom
      function resetZoom() {
        currentZoom = 1;
        currentX = 0;
        currentY = 0;
        updateTransform();
        showZoomPercentage();
      }

      // Momentum scrolling
      function applyMomentum() {
        if (Math.abs(velocityX) < MIN_VELOCITY && Math.abs(velocityY) < MIN_VELOCITY) {
          cancelAnimationFrame(momentumAnimation);
          momentumAnimation = null;
          return;
        }

        currentX += velocityX;
        currentY += velocityY;
        velocityX *= MOMENTUM_FRICTION;
        velocityY *= MOMENTUM_FRICTION;

        updateTransform();
        momentumAnimation = requestAnimationFrame(applyMomentum);
      }

      // Mouse/touch drag functionality with momentum
      function handleDragStart(e) {
        if (momentumAnimation) {
          cancelAnimationFrame(momentumAnimation);
          momentumAnimation = null;
        }

        if (currentZoom <= 1) return;

        isDragging = true;
        zoomContainer.classList.add('dragging');

        const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

        startX = clientX - currentX;
        startY = clientY - currentY;
        lastMoveX = clientX;
        lastMoveY = clientY;
        lastMoveTime = Date.now();
        velocityX = 0;
        velocityY = 0;
      }

      function handleDragMove(e) {
        if (!isDragging) return;
        e.preventDefault();

        const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
        const currentTime = Date.now();

        const deltaTime = currentTime - lastMoveTime;
        if (deltaTime > 0) {
          velocityX = (clientX - lastMoveX) / deltaTime * 16;
          velocityY = (clientY - lastMoveY) / deltaTime * 16;
        }

        currentX = clientX - startX;
        currentY = clientY - startY;
        lastMoveX = clientX;
        lastMoveY = clientY;
        lastMoveTime = currentTime;

        updateTransform();
      }

      function handleDragEnd() {
        isDragging = false;
        zoomContainer.classList.remove('dragging');

        if (currentZoom > 1 && (Math.abs(velocityX) > MIN_VELOCITY || Math.abs(velocityY) > MIN_VELOCITY)) {
          momentumAnimation = requestAnimationFrame(applyMomentum);
        }
      }

      // Scroll/pinch zoom
      function handleWheel(e) {
        e.preventDefault();
        if (e.deltaY < 0) {
          zoomIn();
        } else {
          zoomOut();
        }
      }

      // Touch pinch zoom
      let initialPinchDistance = 0;
      let initialPinchZoom = 1;

      function getTouchDistance(touch1, touch2) {
        const dx = touch1.clientX - touch2.clientX;
        const dy = touch1.clientY - touch2.clientY;
        return Math.sqrt(dx * dx + dy * dy);
      }

      function handleTouchStart(e) {
        if (e.touches.length === 2) {
          e.preventDefault();
          initialPinchDistance = getTouchDistance(e.touches[0], e.touches[1]);
          initialPinchZoom = currentZoom;
          isSwipeGesture = false;
        } else if (e.touches.length === 1) {
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
          swipeStartX = e.touches[0].clientX;
          swipeStartY = e.touches[0].clientY;
          isSwipeGesture = currentZoom <= 1;

          if (currentZoom > 1) {
            handleDragStart(e);
          }
        }
      }

      function handleTouchMove(e) {
        if (e.touches.length === 2) {
          e.preventDefault();
          const currentDistance = getTouchDistance(e.touches[0], e.touches[1]);
          const scale = currentDistance / initialPinchDistance;
          currentZoom = Math.min(Math.max(initialPinchZoom * scale, MIN_ZOOM), MAX_ZOOM);
          updateTransform();
          showZoomPercentage();
        } else if (e.touches.length === 1) {
          if (currentZoom > 1 && isDragging) {
            handleDragMove(e);
          } else if (isSwipeGesture) {
            const deltaY = e.touches[0].clientY - swipeStartY;
            if (Math.abs(deltaY) > Math.abs(e.touches[0].clientX - swipeStartX) && deltaY > 0) {
              e.preventDefault();
              const opacity = Math.max(0, 1 - deltaY / 300);
              modal.style.opacity = opacity;
            }
          }
        }
      }

      function handleTouchEnd(e) {
        if (e.touches.length < 2) {
          initialPinchDistance = 0;
        }

        if (e.touches.length === 0) {
          if (isSwipeGesture && currentZoom <= 1) {
            const deltaX = e.changedTouches[0].clientX - touchStartX;
            const deltaY = e.changedTouches[0].clientY - touchStartY;

            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > SWIPE_THRESHOLD) {
              if (deltaX > 0) {
                navigatePrev();
              } else {
                navigateNext();
              }
            } else if (deltaY > SWIPE_CLOSE_THRESHOLD && Math.abs(deltaY) > Math.abs(deltaX)) {
              closeZoomModal();
            }

            modal.style.opacity = '';
          }

          handleDragEnd();
          isSwipeGesture = false;
        }
      }

      // Event listeners for controls
      closeBtn.addEventListener('click', closeZoomModal);
      zoomInBtn.addEventListener('click', zoomIn);
      zoomOutBtn.addEventListener('click', zoomOut);
      zoomResetBtn.addEventListener('click', resetZoom);
      prevBtn.addEventListener('click', navigatePrev);
      nextBtn.addEventListener('click', navigateNext);

      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal || e.target === zoomContainer) {
          closeZoomModal();
        }
      });

      // Drag events
      zoomContainer.addEventListener('mousedown', handleDragStart);
      document.addEventListener('mousemove', handleDragMove);
      document.addEventListener('mouseup', handleDragEnd);

      // Touch events
      zoomContainer.addEventListener('touchstart', handleTouchStart, { passive: false });
      zoomContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
      zoomContainer.addEventListener('touchend', handleTouchEnd);

      // Wheel zoom
      zoomContainer.addEventListener('wheel', handleWheel, { passive: false });

      // Keyboard shortcuts
      document.addEventListener('keydown', (e) => {
        if (!modal.classList.contains('active')) return;

        switch(e.key) {
          case 'Escape':
            closeZoomModal();
            break;
          case '+':
          case '=':
            e.preventDefault();
            zoomIn();
            break;
          case '-':
          case '_':
            e.preventDefault();
            zoomOut();
            break;
          case '0':
            e.preventDefault();
            resetZoom();
            break;
          case 'd':
          case 'D':
            e.preventDefault();
            downloadBtn.click();
            break;
          case 'ArrowLeft':
            e.preventDefault();
            if (currentZoom > 1) {
              currentX += 50;
              updateTransform();
            } else if (galleryImages.length > 1) {
              navigatePrev();
            }
            break;
          case 'ArrowRight':
            e.preventDefault();
            if (currentZoom > 1) {
              currentX -= 50;
              updateTransform();
            } else if (galleryImages.length > 1) {
              navigateNext();
            }
            break;
          case 'ArrowUp':
            e.preventDefault();
            if (currentZoom > 1) {
              currentY += 50;
              updateTransform();
            }
            break;
          case 'ArrowDown':
            e.preventDefault();
            if (currentZoom > 1) {
              currentY -= 50;
              updateTransform();
            }
            break;
          case 'Home':
            e.preventDefault();
            navigateFirst();
            break;
          case 'End':
            e.preventDefault();
            navigateLast();
            break;
        }
      });

      // Make all flyer images clickable
      function initializeZoomableImages() {
        const flyerImages = document.querySelectorAll('.flyer-image-wrapper img');

        flyerImages.forEach(img => {
          img.addEventListener('click', function(e) {
            e.preventDefault();
            openZoomModal(this);
          });
        });
      }

      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeZoomableImages);
      } else {
        initializeZoomableImages();
      }
    })();
  </script>

</body>
</html>
